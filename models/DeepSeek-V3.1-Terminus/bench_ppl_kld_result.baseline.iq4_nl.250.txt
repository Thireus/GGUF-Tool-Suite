ggml_cuda_init: GGML_CUDA_FORCE_MMQ:    no
ggml_cuda_init: GGML_CUDA_FORCE_CUBLAS: no
ggml_cuda_init: found 4 CUDA devices:
  Device 0: NVIDIA RTX PRO 6000 Blackwell Workstation Edition, compute capability 12.0, VMM: yes, VRAM: 97886 MiB
  Device 1: NVIDIA RTX PRO 6000 Blackwell Workstation Edition, compute capability 12.0, VMM: yes, VRAM: 97886 MiB
  Device 2: NVIDIA RTX PRO 6000 Blackwell Workstation Edition, compute capability 12.0, VMM: yes, VRAM: 97886 MiB
  Device 3: NVIDIA GeForce RTX 5090, compute capability 12.0, VMM: yes, VRAM: 32606 MiB
main: build = 1 (d67e4da)
main: built with MSVC 19.44.35222.0 for 
main: seed  = 1337
CUDA0: using device CUDA0 - 95287 MiB free
CUDA1: using device CUDA1 - 95287 MiB free
CUDA2: using device CUDA2 - 95287 MiB free
CUDA3: using device CUDA3 - 30930 MiB free
llama_model_loader: max stdio successfully set to 2048
llama_model_loader: additional 1086 GGUFs metadata loaded.
llama_model_loader: loaded meta data with 50 key-value pairs and 1086 tensors from ./DeepSeek-V3.1-Terminus-THIREUS-BF16-SPECIAL_TENSOR-00001-of-01087.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = deepseek2
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = DeepSeek V3.1 Terminus Bf16 Safetensors
llama_model_loader: - kv   3:                           general.finetune str              = safetensors
llama_model_loader: - kv   4:                           general.basename str              = DeepSeek-V3.1-Terminus
llama_model_loader: - kv   5:                         general.size_label str              = 256x20B
llama_model_loader: - kv   6:                      deepseek2.block_count u32              = 61
llama_model_loader: - kv   7:                   deepseek2.context_length u32              = 163840
llama_model_loader: - kv   8:                 deepseek2.embedding_length u32              = 7168
llama_model_loader: - kv   9:              deepseek2.feed_forward_length u32              = 18432
llama_model_loader: - kv  10:             deepseek2.attention.head_count u32              = 128
llama_model_loader: - kv  11:          deepseek2.attention.head_count_kv u32              = 1
llama_model_loader: - kv  12:                   deepseek2.rope.freq_base f32              = 10000.000000
llama_model_loader: - kv  13: deepseek2.attention.layer_norm_rms_epsilon f32              = 0.000001
llama_model_loader: - kv  14:                deepseek2.expert_used_count u32              = 8
llama_model_loader: - kv  15:             deepseek2.attention.key_length u32              = 576
llama_model_loader: - kv  16:           deepseek2.attention.value_length u32              = 512
llama_model_loader: - kv  17:                          general.file_type u32              = 32
llama_model_loader: - kv  18:        deepseek2.leading_dense_block_count u32              = 3
llama_model_loader: - kv  19:                       deepseek2.vocab_size u32              = 129280
llama_model_loader: - kv  20:            deepseek2.attention.q_lora_rank u32              = 1536
llama_model_loader: - kv  21:           deepseek2.attention.kv_lora_rank u32              = 512
llama_model_loader: - kv  22:         deepseek2.attention.key_length_mla u32              = 192
llama_model_loader: - kv  23:       deepseek2.attention.value_length_mla u32              = 128
llama_model_loader: - kv  24:       deepseek2.expert_feed_forward_length u32              = 2048
llama_model_loader: - kv  25:                     deepseek2.expert_count u32              = 256
llama_model_loader: - kv  26:              deepseek2.expert_shared_count u32              = 1
llama_model_loader: - kv  27:             deepseek2.expert_weights_scale f32              = 2.500000
llama_model_loader: - kv  28:              deepseek2.expert_weights_norm bool             = true
llama_model_loader: - kv  29:               deepseek2.expert_gating_func u32              = 2
llama_model_loader: - kv  30:             deepseek2.rope.dimension_count u32              = 64
llama_model_loader: - kv  31:                deepseek2.rope.scaling.type str              = yarn
llama_model_loader: - kv  32:              deepseek2.rope.scaling.factor f32              = 40.000000
llama_model_loader: - kv  33: deepseek2.rope.scaling.original_context_length u32              = 4096
llama_model_loader: - kv  34: deepseek2.rope.scaling.yarn_log_multiplier f32              = 0.100000
llama_model_loader: - kv  35:               general.quantization_version u32              = 2
llama_model_loader: - kv  36:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  37:                         tokenizer.ggml.pre str              = deepseek-v3
llama_model_loader: - kv  38:                      tokenizer.ggml.tokens arr[str,129280]  = ["<ï½œbeginâ–ofâ–sentenceï½œ>", "<ï...
llama_model_loader: - kv  39:                  tokenizer.ggml.token_type arr[i32,129280]  = [3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  40:                      tokenizer.ggml.merges arr[str,127741]  = ["Ä  t", "Ä  a", "i n", "Ä  Ä ", "h e...
llama_model_loader: - kv  41:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  42:                tokenizer.ggml.eos_token_id u32              = 1
llama_model_loader: - kv  43:            tokenizer.ggml.padding_token_id u32              = 1
llama_model_loader: - kv  44:               tokenizer.ggml.add_bos_token bool             = true
llama_model_loader: - kv  45:               tokenizer.ggml.add_eos_token bool             = false
llama_model_loader: - kv  46:                    tokenizer.chat_template str              = {% if not add_generation_prompt is de...
llama_model_loader: - kv  47:                                   split.no u16              = 0
llama_model_loader: - kv  48:                                split.count u16              = 1087
llama_model_loader: - kv  49:                        split.tensors.count i32              = 1086
llama_model_loader: - type  f32:  361 tensors
llama_model_loader: - type iq4_nl:  725 tensors
load: special_eos_id is not in special_eog_ids - the tokenizer config may be incorrect
load: printing all EOG tokens:
load:   - 1 ('<ï½œendâ–ofâ–sentenceï½œ>')
load: special tokens cache size = 818
load: token to piece cache size = 0.8223 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = deepseek2
llm_load_print_meta: n_ctx_train      = 163840
llm_load_print_meta: n_embd           = 7168
llm_load_print_meta: n_layer          = 61
llm_load_print_meta: n_head           = 128
llm_load_print_meta: n_head_kv        = 128
llm_load_print_meta: n_rot            = 64
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_swa_pattern    = 1
llm_load_print_meta: n_embd_head_k    = 192
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 24576
llm_load_print_meta: n_embd_v_gqa     = 16384
llm_load_print_meta: f_norm_eps       = 0.0e+00
llm_load_print_meta: f_norm_rms_eps   = 1.0e-06
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 18432
llm_load_print_meta: n_expert         = 256
llm_load_print_meta: n_expert_used    = 8
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 0
llm_load_print_meta: rope scaling     = yarn
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 0.025
llm_load_print_meta: n_ctx_orig_yarn  = 4096
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: model type       = 671B
llm_load_print_meta: model ftype      = BF16
llm_load_print_meta: model params     = 671.026 B
llm_load_print_meta: model size       = 351.874 GiB (4.504 BPW) 
llm_load_print_meta: repeating layers = 350.903 GiB (4.504 BPW, 669.173 B parameters)
llm_load_print_meta: general.name     = DeepSeek V3.1 Terminus Bf16 Safetensors
llm_load_print_meta: n_layer_dense_lead   = 3
llm_load_print_meta: n_lora_q             = 1536
llm_load_print_meta: n_lora_kv            = 512
llm_load_print_meta: n_ff_exp             = 2048
llm_load_print_meta: n_expert_shared      = 1
llm_load_print_meta: expert_weights_scale = 2.5
llm_load_print_meta: expert_weights_norm  = 1
llm_load_print_meta: expert_gating_func   = sigmoid
llm_load_print_meta: rope_yarn_log_mul    = 0.1000
print_info: vocab type       = BPE
print_info: n_vocab          = 129280
print_info: n_merges         = 127741
print_info: BOS token        = 0 '<ï½œbeginâ–ofâ–sentenceï½œ>'
print_info: EOS token        = 1 '<ï½œendâ–ofâ–sentenceï½œ>'
print_info: EOT token        = 1 '<ï½œendâ–ofâ–sentenceï½œ>'
print_info: PAD token        = 1 '<ï½œendâ–ofâ–sentenceï½œ>'
print_info: LF token         = 201 'ÄŠ'
print_info: FIM PRE token    = 128801 '<ï½œfimâ–beginï½œ>'
print_info: FIM SUF token    = 128800 '<ï½œfimâ–holeï½œ>'
print_info: FIM MID token    = 128802 '<ï½œfimâ–endï½œ>'
print_info: EOG token        = 1 '<ï½œendâ–ofâ–sentenceï½œ>'
print_info: max token length = 256
llm_load_tensors: ggml ctx size =   13.28 MiB
Tensor blk.3.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.3.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.3.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.3.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.3.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.3.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.3.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.3.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.4.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.5.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.6.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.7.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.8.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.9.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.10.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.11.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.12.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.13.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.14.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.15.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_norm.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_gate_inp.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_up_exps.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_gate_exps.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_down_exps.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_gate_shexp.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_down_shexp.weight buffer type overriden to CUDA0
Tensor blk.16.ffn_up_shexp.weight buffer type overriden to CUDA0
Tensor blk.17.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.17.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.17.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.17.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.17.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.17.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.17.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.17.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.18.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.19.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.20.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.21.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.22.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.23.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.24.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.25.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.26.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.27.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.28.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.29.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_norm.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_gate_inp.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_up_exps.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_gate_exps.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_down_exps.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_gate_shexp.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_down_shexp.weight buffer type overriden to CUDA1
Tensor blk.30.ffn_up_shexp.weight buffer type overriden to CUDA1
Tensor blk.31.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.31.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.31.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.31.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.31.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.31.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.31.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.31.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.32.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.33.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.34.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.35.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.36.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.37.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.38.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.39.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.40.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.41.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.42.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.43.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_norm.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_gate_inp.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_up_exps.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_gate_exps.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_down_exps.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_gate_shexp.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_down_shexp.weight buffer type overriden to CUDA2
Tensor blk.44.ffn_up_shexp.weight buffer type overriden to CUDA2
Tensor blk.45.ffn_norm.weight buffer type overriden to CUDA3
Tensor blk.45.ffn_gate_inp.weight buffer type overriden to CUDA3
Tensor blk.45.ffn_up_exps.weight buffer type overriden to CUDA3
Tensor blk.45.ffn_gate_exps.weight buffer type overriden to CUDA3
Tensor blk.45.ffn_down_exps.weight buffer type overriden to CUDA3
Tensor blk.45.ffn_gate_shexp.weight buffer type overriden to CUDA3
Tensor blk.45.ffn_down_shexp.weight buffer type overriden to CUDA3
Tensor blk.45.ffn_up_shexp.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_norm.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_gate_inp.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_up_exps.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_gate_exps.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_down_exps.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_gate_shexp.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_down_shexp.weight buffer type overriden to CUDA3
Tensor blk.46.ffn_up_shexp.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_norm.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_gate_inp.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_up_exps.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_gate_exps.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_down_exps.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_gate_shexp.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_down_shexp.weight buffer type overriden to CUDA3
Tensor blk.47.ffn_up_shexp.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_norm.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_gate_inp.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_up_exps.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_gate_exps.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_down_exps.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_gate_shexp.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_down_shexp.weight buffer type overriden to CUDA3
Tensor blk.48.ffn_up_shexp.weight buffer type overriden to CUDA3
Tensor blk.49.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.49.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.49.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.50.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.50.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.50.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.51.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.51.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.51.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.52.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.52.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.52.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.53.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.53.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.53.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.54.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.54.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.54.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.55.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.55.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.55.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.56.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.56.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.56.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.57.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.57.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.57.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.58.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.58.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.58.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.59.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.59.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.59.ffn_down_exps.weight buffer type overriden to CPU
Tensor blk.60.ffn_up_exps.weight buffer type overriden to CPU
Tensor blk.60.ffn_gate_exps.weight buffer type overriden to CPU
Tensor blk.60.ffn_down_exps.weight buffer type overriden to CPU
llm_load_tensors: offloading 61 repeating layers to GPU
llm_load_tensors: offloading non-repeating layers to GPU
llm_load_tensors: offloaded 62/62 layers to GPU
llm_load_tensors:        CPU buffer size = 72576.00 MiB
llm_load_tensors:  CUDA_Host buffer size =   497.11 MiB
llm_load_tensors:      CUDA0 buffer size = 87646.83 MiB
llm_load_tensors:      CUDA1 buffer size = 87008.87 MiB
llm_load_tensors:      CUDA2 buffer size = 87123.03 MiB
llm_load_tensors:      CUDA3 buffer size = 25467.05 MiB
....................................................................................................
============ llm_prepare_mla: need to compute 61 wkv_b tensors
================= Adjusted mainline llama.cpp MLA tensors to ik_llama.cpp
Computed blk.0.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.1.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.2.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.3.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.4.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.5.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.6.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.7.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.8.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.9.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.10.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.11.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.12.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.13.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.14.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.15.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.16.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.17.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.18.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA0
Computed blk.19.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.20.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.21.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.22.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.23.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.24.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.25.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.26.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.27.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.28.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.29.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.30.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.31.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.32.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.33.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.34.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.35.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.36.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.37.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA1
Computed blk.38.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.39.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.40.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.41.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.42.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.43.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.44.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.45.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.46.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.47.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.48.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.49.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.50.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.51.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.52.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.53.attn_kv_b.weight as 512 x 32768 and storellama_new_context_with_model: n_ctx         = 4096
llama_new_context_with_model: n_batch       = 4096
llama_new_context_with_model: n_ubatch      = 4096
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: mla_attn      = 3
llama_new_context_with_model: attn_max_b    = 1024
llama_new_context_with_model: fused_moe     = 1
llama_new_context_with_model: grouped er    = 0
llama_new_context_with_model: fused_up_gate = 1
llama_new_context_with_model: fused_mmad    = 1
llama_new_context_with_model: rope_cache    = 0
llama_new_context_with_model: graph_reuse   = 1
llama_new_context_with_model: k_cache_hadam = 0
llama_new_context_with_model: split_mode_graph_scheduling = 0
llama_new_context_with_model: split_mode_f16= 1
llama_new_context_with_model: sched_async   = 0
llama_new_context_with_model: ser           = -1, 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 0.025
llama_kv_cache_init:      CUDA0 KV buffer size =    85.50 MiB
llama_kv_cache_init:      CUDA1 KV buffer size =    85.50 MiB
llama_kv_cache_init:      CUDA2 KV buffer size =    81.00 MiB
llama_kv_cache_init:      CUDA3 KV buffer size =    22.50 MiB
llama_new_context_with_model: KV self size  =  274.50 MiB, c^KV (f16):  274.50 MiB, kv^T: not used
llama_new_context_with_model:  CUDA_Host  output buffer size =     3.95 MiB
llama_new_context_with_model:      CUDA0 compute buffer size =  4404.00 MiB
llama_new_context_with_model:      CUDA1 compute buffer size =  1652.26 MiB
llama_new_context_with_model:      CUDA2 compute buffer size =  1652.26 MiB
llama_new_context_with_model:      CUDA3 compute buffer size =  2132.00 MiB
llama_new_context_with_model:  CUDA_Host compute buffer size =   144.05 MiB
llama_new_context_with_model: graph nodes  = 3248
llama_new_context_with_model: graph splits = 89
XXXXXXXXXXXXXXXXXXXXX Setting only active experts offload

system_info: n_threads = 36 / 36 | AVX = 1 | AVX_VNNI = 0 | AVX2 = 1 | AVX512 = 1 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | FMA = 1 | NEON = 0 | SVE = 0 | ARM_FMA = 0 | F16C = 1 | FP16_VA = 0 | WASM_SIMD = 0 | BLAS = 1 | SSE3 = 1 | SSSE3 = 1 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
perplexity: saving all logits to bench_kld_result.baseline.iq4_nl.250.bin
perplexity: tokenizing the input ..
perplexity: tokenization took 2518.38 ms
perplexity: calculating perplexity over 250 chunks, n_ctx=512, batch_size=4096, n_seq=8
perplexity: 16.02 seconds per pass - ETA 8.33 minutes
d in buffer CUDA2
Computed blk.54.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.55.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA2
Computed blk.56.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA3
Computed blk.57.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA3
Computed blk.58.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA3
Computed blk.59.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA3
Computed blk.60.attn_kv_b.weight as 512 x 32768 and stored in buffer CUDA3
[1]62.9082,[2]10.6184,[3]5.7710,[4]3.7478,[5]2.9570,[6]2.5007,[7]2.2191,[8]2.0196,[9]1.9037,[10]1.8206,[11]2.0431,[12]2.1029,[13]2.1187,[14]2.1616,[15]2.0561,[16]1.9666,[17]1.8957,[18]1.8319,[19]1.7889,[20]1.7436,[21]1.7101,[22]1.6706,[23]1.6424,[24]1.6320,[25]1.6208,[26]1.5942,[27]1.6914,[28]1.7688,[29]1.8352,[30]1.8304,[31]1.8424,[32]1.8400,[33]1.8165,[34]1.8548,[35]1.8301,[36]1.8294,[37]1.8179,[38]1.8267,[39]1.8149,[40]1.7937,[41]1.7721,[42]1.7537,[43]1.7441,[44]1.7322,[45]1.7240,[46]1.7204,[47]1.7198,[48]1.7085,[49]1.6976,[50]1.6901,[51]1.6865,[52]1.6860,[53]1.6902,[54]1.7064,[55]1.7028,[56]1.6926,[57]1.7003,[58]1.7045,[59]1.7156,[60]1.7101,[61]1.7506,[62]1.7844,[63]1.8197,[64]1.8523,[65]1.9016,[66]1.9158,[67]1.9530,[68]1.9824,[69]2.0406,[70]2.0930,[71]2.1241,[72]2.1547,[73]2.1681,[74]2.1828,[75]2.2149,[76]2.2443,[77]2.2621,[78]2.2587,[79]2.2727,[80]2.2959,[81]2.3333,[82]2.3694,[83]2.3797,[84]2.4104,[85]2.4209,[86]2.4207,[87]2.4497,[88]2.4807,[89]2.5375,[90]2.5575,[91]2.5573,[92]2.5642,[93]2.5800,[94]2.5885,[95]2.6215,[96]2.6093,[97]2.6478,[98]2.6734,[99]2.6626,[100]2.6953,[101]2.7430,[102]2.7752,[103]2.8163,[104]2.8450,[105]2.8741,[106]2.9122,[107]2.9038,[108]2.9210,[109]2.9282,[110]2.9339,[111]2.9287,[112]2.9638,[113]2.9904,[114]2.9990,[115]2.9839,[116]2.9581,[117]2.9515,[118]2.9619,[119]2.9490,[120]2.9262,[121]2.9212,[122]2.9213,[123]2.9288,[124]2.9359,[125]2.9425,[126]2.9496,[127]2.9548,[128]2.9846,[129]3.0004,[130]2.9755,[131]2.9509,[132]2.9269,[133]2.9034,[134]2.9060,[135]2.9049,[136]2.9318,[137]2.9643,[138]2.9836,[139]2.9868,[140]3.0114,[141]3.0361,[142]3.0645,[143]3.0851,[144]3.1069,[145]3.1272,[146]3.1469,[147]3.1648,[148]3.1723,[149]3.1819,[150]3.1870,[151]3.2055,[152]3.2237,[153]3.2237,[154]3.2320,[155]3.2430,[156]3.2522,[157]3.2626,[158]3.2690,[159]3.2777,[160]3.2923,[161]3.2976,[162]3.2998,[163]3.3064,[164]3.3165,[165]3.3183,[166]3.3190,[167]3.3366,[168]3.3466,[169]3.3538,[170]3.3716,[171]3.3859,[172]3.3816,[173]3.3881,[174]3.3890,[175]3.4027,[176]3.4129,[177]3.4253,[178]3.4202,[179]3.4165,[180]3.4112,[181]3.4057,[182]3.3995,[183]3.3946,[184]3.3886,[185]3.4019,[186]3.4307,[187]3.4542,[188]3.4766,[189]3.4976,[190]3.5285,[191]3.5429,[192]3.5578,[193]3.5480,[194]3.5649,[195]3.5568,[196]3.5371,[197]3.5156,[198]3.5357,[199]3.5529,[200]3.5623,[201]3.5706,[202]3.5866,[203]3.6042,[204]3.6167,[205]3.6296,[206]3.6451,[207]3.6432,[208]3.6208,[209]3.5988,[210]3.5769,[211]3.5556,[212]3.5347,[213]3.5139,[214]3.5208,[215]3.5475,[216]3.5390,[217]3.5352,[218]3.5611,[219]3.5735,[220]3.5915,[221]3.6133,[222]3.6309,[223]3.6421,[224]3.6641,[225]3.6751,[226]3.7030,[227]3.7300,[228]3.7504,[229]3.7609,[230]3.7597,[231]3.7773,[232]3.7987,[233]3.8068,[234]3.8131,[235]3.8396,[236]3.8452,[237]3.8753,[238]3.9039,[239]3.9128,[240]3.9248,[241]3.9492,[242]3.9584,[243]3.9714,[244]3.9856,[245]4.0050,[246]4.0266,[247]4.0278,[248]4.0360,[249]4.0454,[250]4.0554,
llama_print_timings:        load time =  231467.52 ms
llama_print_timings:      sample time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
llama_print_timings: prompt eval time =  436150.32 ms / 128000 tokens (    3.41 ms per token,   293.48 tokens per second)
llama_print_timings:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
llama_print_timings:       total time =  456512.48 ms / 128001 tokens

Final estimate: PPL over 250 chunks for n_ctx=512 = 4.0554 +/- 0.03816
